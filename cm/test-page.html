<html>
<head></head>
<body>
 <div id="myEvent" class="event scene_element scene_element--fadeinup"></div>

  <!--  working without oauth-->
    <script type="text/javascript">
        // this apiKey is managed in shane's google developer account
        var apiKey = 'AIzaSyAC5jKXdm5Fdap-kqNVOI23c7a9fOV0lOY';
        var scopes = ["https://www.googleapis.com/auth/spreadsheets.readonly"];
        var discoveryUrl = 'https://sheets.googleapis.com/$discovery/rest?version=v4';

        function handleClientLoad() {
            gapi.client.setApiKey(apiKey);
            makeApiCall();
        }

        function makeApiCall() {
          gapi.client.load(discoveryUrl).then(listMajors);
        }


      /**
       * Print the names and majors of students in a sample spreadsheet:
       * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
       */
      function listMajors() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1cRTwDZO8O_5qIuxSyA6iAu1RBvNaVs9a3Ogip5VvV_g',
          range: 'Sheet1!A2:E',
        }).then(function(response) {
          var range = response.result;
          if (range.values.length > 0) {
            appendPre('Name, Major:');
            for (i = 0; i < range.values.length; i++) {
              var row = range.values[i];
              // Print columns A and E, which correspond to indices 0 and 4.
              appendPre(row[0] + ', ' + row[4]);
            }
          } else {
            appendPre('No data found.');
          }
        }, function(response) {
          appendPre('Error: ' + response.result.error.message);
        });
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('output');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
<pre id="output"></pre>
</body>
</html>